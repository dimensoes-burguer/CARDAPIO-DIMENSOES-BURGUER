<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio - DIMENS√ïES BURGUER</title>
    <style>
        /* Paleta de Cores e Estilos Anteriores... */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding-bottom: 100px; color: #ffffff; background-image: url('https://i.imgur.com/se61g1G.png'); background-size: cover; background-position: center; background-attachment: fixed; position: relative; overflow-x: hidden; }
        body::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(8px); z-index: -1; }
        .container { max-width: 700px; margin: 20px auto; background: rgba(255, 255, 255, 0.9); padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); color: #333333; }
        .header { text-align: center; margin-bottom: 25px; }
        .header h1 { font-size: 2.5rem; color: #1a1a1a; margin-bottom: 5px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        .header p { color: #606770; font-size: 1rem; }
        .section-title { font-size: 1.6rem; color: #673AB7; border-bottom: 2px solid #FFC107; padding-bottom: 10px; margin-top: 30px; margin-bottom: 20px; text-align: center; }
        .catalog-btn { display: inline-block; margin-top: 20px; padding: 12px 25px; background-color: #FFC107; color: #1a1a1a; text-decoration: none; font-weight: bold; font-size: 1.1rem; border-radius: 8px; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .catalog-btn:hover { transform: scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .menu-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid #dddfe2; }
        .item-details strong { color: #1a1a1a; font-size: 1.1rem; }
        .item-purchase { display: flex; align-items: center; gap: 15px; }
        .item-purchase span { color: #606770; font-size: 1rem; }
        .add-button { background-color: #4CAF50; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; transition: background-color 0.3s; font-weight: 500; }
        .add-button:hover { background-color: #8BC34A; }
        .floating-cart { position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; background: rgba(255, 255, 255, 0.95); box-shadow: 0 -4px 12px rgba(0,0,0,0.25); border-top-left-radius: 16px; border-top-right-radius: 16px; max-width: 700px; margin: 0 auto; color: #333333; }
        .cart-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; cursor: pointer; background-color: rgba(255, 255, 255, 0.98);}
        .cart-header h3 { margin: 0; font-size: 1.2rem; color: #1a1a1a; }
        #cart-toggle-icon { font-size: 1.5rem; transition: transform 0.3s; color: #673AB7; }
        .cart-body { max-height: 0; overflow-y: auto; transition: max-height 0.4s ease-in-out; }
        .cart-body.expanded { max-height: 40vh; }
        #cart-items { padding: 0 20px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee;}
        .remove-item-btn { background: transparent; border: none; color: #ff3b30; font-size: 1.2rem; cursor: pointer; font-weight: bold; }
        .cart-footer { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #eee; }
        .cart-total { font-size: 1.2rem; font-weight: bold; color: #1a1a1a; }
        .cart-checkout-btn { background-color: #4CAF50; color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .cart-checkout-btn:disabled { background-color: #8BC34A; }
        #cart-empty-message { text-align: center; padding: 20px; color: #606770; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 25px; border-radius: 12px; max-width: 500px; width: 90%; color: #333333; }
        .modal-content h2 { margin-top: 0; color: #1a1a1a; }
        label { font-weight: 600; margin-bottom: 8px; color: #333; display: block; margin-top: 15px;}
        input[type="text"], select, textarea { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #dddfe2; box-sizing: border-box; font-size: 1rem; }
        textarea { resize: vertical; min-height: 80px;}
        .modal-actions { display: flex; justify-content: space-between; gap: 10px; margin-top: 20px;}
        .modal-actions button { flex-grow: 1; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; }
        #cancel-btn { background-color: #FFC107; color: #333; }
        #confirm-btn { background-color: #4CAF50; color: white; }
        
        /* === NOVOS ESTILOS PARA O FRETE === */
        #location-btn { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; margin-bottom: 15px;}
        #location-btn:disabled { background-color: #aaa; }
        #frete-info { background-color: #f0f8ff; padding: 10px; border-radius: 6px; margin-top: 10px; text-align: center; font-size: 1rem; display: none;}

    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>üçî DIMENS√ïES BURGUER üçî</h1>
            <p>Escolha seus itens, adicione ao carrinho e feche o pedido!</p>
            <a href="https://wa.me/c/556291014682" target="_blank" class="catalog-btn">üì∑ Ver Fotos no Cat√°logo</a>
        </div>
        
        <h2 class="section-title">ü•™ Lanches Individuais</h2>
        <div id="lanches-menu"></div>
        <h2 class="section-title">üçü Combos com Fritas e Refrigerante</h2>
        <div id="combos-menu"></div>
        <h2 class="section-title">ü•§ Bebidas</h2>
        <div id="bebidas-menu"></div>
    </div>

    <div class="floating-cart">
        <div class="cart-header" onclick="toggleCart()">
            <h3>üõí Seu Carrinho</h3>
            <span id="cart-toggle-icon">‚ñ≤</span>
        </div>
        <div class="cart-body" id="cart-body">
            <div id="cart-items"></div>
            <p id="cart-empty-message">Seu carrinho est√° vazio.</p>
        </div>
        <div class="cart-footer">
            <span class="cart-total" id="cart-total">Total: R$ 0,00</span>
            <button class="cart-checkout-btn" id="checkout-btn" onclick="showOrderModal()" disabled>Continuar Pedido</button>
        </div>
    </div>

    <div class="modal-overlay" id="order-modal">
        <div class="modal-content">
            <h2>Falta pouco!</h2>
            <p>Preencha seus dados para concluir o pedido.</p>
            
            <label for="nome">Seu Nome:</label>
            <input type="text" id="nome" name="nome" placeholder="Digite seu nome completo" required>
            
            <button type="button" id="location-btn" onclick="calculateDelivery()">üìç Calcular Frete com Minha Localiza√ß√£o</button>
            <div id="frete-info"></div>
            
            <label for="endereco">Ou digite seu Endere√ßo Completo:</label>
            <input type="text" id="endereco" name="endereco" placeholder="Caso n√£o queira usar a localiza√ß√£o" required>

            <label for="obs">Observa√ß√µes (opcional):</label>
            <textarea id="obs" name="obs" placeholder="Ex: Tirar a cebola, ponto da carne, etc."></textarea>
            
            <label for="pagamento">Forma de Pagamento:</label>
            <select id="pagamento" name="pagamento">
                <option value="Dinheiro">Dinheiro</option>
                <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
                <option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option>
                <option value="Pix">Pix</option>
            </select>
            <div class="modal-actions">
                <button id="cancel-btn" onclick="hideOrderModal()">Cancelar</button>
                <button id="confirm-btn" onclick="enviarPedido()">Enviar para o WhatsApp</button>
            </div>
        </div>
    </div>

    <script>
        // CARD√ÅPIO E CONSTANTES
        const lanches = [ { nome: "BARATIN", preco: 14.99 }, { nome: "SMASH 1.0", preco: 19.99 }, { nome: "SMASH 2.0", preco: 27.99 }, { nome: "SMASH 3.0", preco: 33.99 }, { nome: "ONION RINGS", preco: 29.99 }, { nome: "VULCANO", preco: 24.99 }, { nome: "VULCANO DIMENSIONAL", preco: 31.99 } ];
        const combos = [ { nome: "COMBO BARATIN", preco: 25.99 }, { nome: "COMBO SMASH 1.0", preco: 31.99 }, { nome: "COMBO SMASH 2.0", preco: 38.99 }, { nome: "COMBO SMASH 3.0", preco: 46.99 }, { nome: "COMBO ONION RINGS", preco: 41.99 }, { nome: "COMBO VULCANO", preco: 35.99 }, { nome: "COMBO VULCANO DIMENSIONAL", preco: 44.99 } ];
        const bebidas = [ { nome: "Refri Lata", preco: 4.50 }, { nome: "Coca-Cola 600ml", preco: 6.00 }, { nome: "Guaran√° 1L", preco: 6.50 } ];
        const hamburgueriaCoords = { lat: -16.650244, lon: -49.153223 };

        // ELEMENTOS DA P√ÅGINA
        const cartItemsContainer = document.getElementById('cart-items');
        const cartBody = document.getElementById('cart-body');
        const cartEmptyMessage = document.getElementById('cart-empty-message');
        const totalElement = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');
        const modal = document.getElementById('order-modal');
        const cartToggleIcon = document.getElementById('cart-toggle-icon');
        const freteInfoDiv = document.getElementById('frete-info');
        
        let cart = [];
        let taxaFrete = 0; // Vari√°vel para armazenar o valor do frete

        // FUN√á√ïES DO MENU
        function renderMenu(menu, containerId) { /* ...c√≥digo existente... */ }

        // FUN√á√ïES DO CARRINHO
        function addToCart(nome, preco) { /* ...c√≥digo existente... */ }
        function removeFromCart(index) { /* ...c√≥digo existente... */ }
        
        function updateCart() {
            cartItemsContainer.innerHTML = '';
            let subtotal = 0;

            if (cart.length === 0) {
                cartEmptyMessage.style.display = 'block';
                checkoutBtn.disabled = true;
            } else {
                cartEmptyMessage.style.display = 'none';
                checkoutBtn.disabled = false;
                cart.forEach((item, index) => {
                    cartItemsContainer.innerHTML += `<div class="cart-item"><span>${item.nome}</span><span>R$ ${item.preco.toFixed(2).replace('.', ',')} <button class="remove-item-btn" onclick="removeFromCart(${index})">√ó</button></span></div>`;
                    subtotal += item.preco;
                });
            }
            const totalFinal = subtotal + taxaFrete;
            totalElement.innerText = `Total: R$ ${totalFinal.toFixed(2).replace('.', ',')}`;
        }
        
        function toggleCart() { /* ...c√≥digo existente... */ }

        // FUN√á√ïES DO MODAL E PEDIDO
        function showOrderModal() { /* ...c√≥digo existente... */ }
        function hideOrderModal() { /* ...c√≥digo existente... */ }

        // === NOVA L√ìGICA DE C√ÅLCULO DE FRETE ===
        function calculateDelivery() {
            if (!navigator.geolocation) {
                alert("Geolocaliza√ß√£o n√£o √© suportada pelo seu navegador. Por favor, digite o endere√ßo manualmente.");
                return;
            }

            const locationBtn = document.getElementById('location-btn');
            locationBtn.disabled = true;
            locationBtn.innerText = "Calculando...";

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const clienteCoords = {
                        lat: position.coords.latitude,
                        lon: position.coords.longitude
                    };

                    const distancia = haversineDistance(hamburgueriaCoords, clienteCoords);
                    const distanciaArredondada = Math.ceil(distancia); // Arredonda pra cima
                    taxaFrete = distanciaArredondada * 2.00; // R$2 por KM

                    freteInfoDiv.innerHTML = `Dist√¢ncia: <strong>${distancia.toFixed(2)} km</strong><br>Taxa de Entrega: <strong>R$ ${taxaFrete.toFixed(2).replace('.', ',')}</strong>`;
                    freteInfoDiv.style.display = 'block';
                    document.getElementById('endereco').value = "Localiza√ß√£o por GPS enviada.";
                    locationBtn.innerText = "Frete Calculado!";
                    
                    updateCart(); // Atualiza o total no carrinho para incluir o frete
                },
                () => {
                    alert("N√£o foi poss√≠vel obter sua localiza√ß√£o. Verifique as permiss√µes do seu navegador e tente novamente, ou digite o endere√ßo manualmente.");
                    locationBtn.disabled = false;
                    locationBtn.innerText = "üìç Tentar Novamente";
                }
            );
        }

        function haversineDistance(coords1, coords2) {
            const R = 6371; // Raio da Terra em km
            const dLat = (coords2.lat - coords1.lat) * Math.PI / 180;
            const dLon = (coords2.lon - coords1.lon) * Math.PI / 180;
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(coords1.lat * Math.PI / 180) * Math.cos(coords2.lat * Math.PI / 180) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c; // Dist√¢ncia em km
        }

        function enviarPedido() {
            const numeroHamburgueria = "556291014682";
            const nomeCliente = document.getElementById("nome").value;
            const endereco = document.getElementById("endereco").value;
            const observacoes = document.getElementById("obs").value;
            const pagamento = document.getElementById("pagamento").value;
            
            let subtotal = 0;
            cart.forEach(item => subtotal += item.preco);
            const totalFinal = subtotal + taxaFrete;

            if (!nomeCliente || !endereco) {
                alert("Por favor, preencha seu nome e endere√ßo (ou calcule o frete pela localiza√ß√£o).");
                return;
            }

            let itensPedido = '';
            cart.forEach(item => {
                itensPedido += `‚ñ™Ô∏è ${item.nome} (R$ ${item.preco.toFixed(2).replace('.', ',')})\n`;
            });

            let textoPedido = `*-- NOVO PEDIDO | DIMENS√ïES BURGUER --* üçî\n\n` +
                              `*Cliente:* ${nomeCliente}\n\n` +
                              `*ITENS DO PEDIDO:*\n${itensPedido}\n` +
                              `*ENDERE√áO DE ENTREGA:*\n${endereco}\n\n`;
            
            if (observacoes) {
                textoPedido += `*OBSERVA√á√ïES:*\n${observacoes}\n\n`;
            }

            textoPedido += `*RESUMO FINANCEIRO:*\n` +
                           `Subtotal dos Itens: R$ ${subtotal.toFixed(2).replace('.', ',')}\n` +
                           `Taxa de Entrega: R$ ${taxaFrete.toFixed(2).replace('.', ',')}\n` +
                           `*Total a Pagar: R$ ${totalFinal.toFixed(2).replace('.', ',')}*\n\n` +
                           `*Forma de Pagamento:* ${pagamento}`;

            const textoCodificado = encodeURIComponent(textoPedido);
            const linkWhatsApp = `https://wa.me/${numeroHamburgueria}?text=${textoCodificado}`;

            window.open(linkWhatsApp, '_blank');
            hideOrderModal();
        }

        // INICIALIZA√á√ÉO
        window.onload = () => {
            renderMenu(lanches, 'lanches-menu');
            renderMenu(combos, 'combos-menu');
            renderMenu(bebidas, 'bebidas-menu');
            updateCart();
        };

        // Preenchendo fun√ß√µes que n√£o foram alteradas mas s√£o necess√°rias
        function renderMenu(menu, containerId) { const container = document.getElementById(containerId); menu.forEach(item => { container.innerHTML += `<div class="menu-item"><div class="item-details"><strong>${item.nome}</strong></div><div class="item-purchase"><span>R$ ${item.preco.toFixed(2).replace('.', ',')}</span><button class="add-button" onclick="addToCart('${item.nome}', ${item.preco})">+</button></div></div>`; }); }
        function addToCart(nome, preco) { cart.push({ nome, preco }); updateCart(); if (!cartBody.classList.contains('expanded')) { toggleCart(); } }
        function removeFromCart(index) { cart.splice(index, 1); updateCart(); }
        function toggleCart() { cartBody.classList.toggle('expanded'); cartToggleIcon.style.transform = cartBody.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0deg)'; }
        function showOrderModal() { modal.style.display = 'flex'; }
        function hideOrderModal() { modal.style.display = 'none'; }
    </script>
</body>
</html>